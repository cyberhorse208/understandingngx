# http performance improve


## 浏览器访问网页的一般过程

一般都要经过下面4个过程

* dns解析


> 与dns服务器之间的数据交换时间，至少需要一个 rtt 


* tcp建立连接


> 与服务器建立tcp连接，3次握手，以及tcp慢启动

* 【如果访问的是https网站，那么还要经过SSL握手】

> 需要 2个rtt时间来进行ssl握手


* 发送请求，到开始接收到第一个byte


> 数据传输时间，服务器处理请求，创建响应时间。

* 内容下载


## http性能优化点

从整体上看，客户端和服务器之间的网络连接优化有两个方向：

* 增大带宽

> 目前的互联网，除针对视频网站，单纯增大带宽带来的用户访问体验优化已经不是特别明显

* 降低延迟

> 降低延迟对一般网页浏览体验优化将非常明显


根据浏览器访问网页的一般过程，以及其中涉及到的消耗时间点，可以考虑从以下方面入手优化，降低延迟。

* 减少dns请求

* 减少不必要http请求

> 识别web app中不必要的资源，并删除；毕竟没有请求肯定比优化的请求快

* 使用CDN

> 目标是将资源部署到里客户端最近的地方，降低tcp连接的网络延迟，提高吞吐率

* 使用客户端缓存

* 压缩响应数据

* 避免http redirect

> 尤其应该避免redirect到一个不同的域名下，那样会导致额外的dns查询，tcp新建连接等。


## 从应用程序或者浏览器角度优化

优化的核心在于 “**预测**”:

* 预测将要访问的链接的域名，进行dns解析，进行tcp连接

> 鼠标悬停某个超链接，可触发此超链接的dns请求，进行tcp连接

> 输入网址过程中，边提示边进行dns请求，进行tcp连接

> 用户经常上的网站，可以预先dns请求，进行tcp连接


* 预测需要访问的页面，获取页面关键资源，并进行预渲染网页

预测也要注意的问题是预测正确率，不正确的预测带来了不必要的资源消耗和网络占用。
